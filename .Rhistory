cdf_ztbinom_book(9, 0.5, 10)
cdf_ztbinom_book(8, 0.5, 10)
library(tidyverse)
d_ztbinom_book <- function(k, p, N) {
q = p + 1
prob = (1/(1-(q^-N))) * choose(n = N+k-1, k = N-1) * (p/q)^k * (1 - (p/q))^N
return(prob)
}
cdf_ztbinom_book <- function(k, p, N) {
q = p + 1
cumulative_prob <- 0
for (i in 1:k) {
cumulative_prob = cumulative_prob + d_ztbinom_book(i, p, N)
}
return(cumulative_prob)
}
mean_ztbinom_book <- function(p, N) {
q = p + 1
mean = N*p / (1-(q^-N))
return(mean)
}
var_ztbinom_book <- function(p, N) {
q = p + 1
var = ( (N*p*q) / (1-(q^-N)) ) * ( 1 - (N*p / q) * ( 1 / (1-(q^-N)) - 1)  )
return(var)
}
d_ztbinom_book(k = 3, p = 0.5, N = 10)
cdf_ztbinom_book(k = 25, p = 0.5, N = 10)
mean_ztbinom_book(p = 0.5, N = 10)
var_ztbinom_book(p = 0.5, N = 10)
# pdf build
pdf <- d_ztbinom_book(k = seq(1, 1000, 1), p = 0.99, N = 100)
pdf_df <- as.data.frame(pdf)
pdf_df <- pdf_df |>
mutate(k = seq(1, 1000, 1)) |>
rename(prob = pdf)
pdf_df |>
ggplot(aes(x = k, y = prob)) +
geom_line() +
theme_bw()
sum(pdf)
cdf <- rep(0, 20)
for (i in 1:20) {
cdf[i] <- cdf_ztbinom_book(k = i, p = 0.5, N = 10)
}
cdf_df <- as.data.frame(cdf)
cdf_df <- cdf_df |>
mutate(k = seq(1, 20, 1)) |>
rename(prob = cdf)
cdf_df |>
ggplot(aes(x = k, y = prob)) +
geom_line() +
theme_bw() +
scale_x_continuous(breaks = seq(0, 20, 1)) +
scale_y_continuous(breaks = seq(-0.1, 1, 0.1))
r_ztbinom_book <- function(n, N, p) {
draws <- rep(NA, n)
upper = N*10
min = cdf_ztbinom_book(k = 1, p = p, N = N)
max = cdf_ztbinom_book(k = upper, p = p, N = N)
# cdf_vals <- cdf_ztbinom_book(seq(1, N*10, 1), p = p, N = N)
cdf_vals <- rep(0, upper)
for (i in 1:upper) {
cdf_vals[i] <- cdf_ztbinom_book(k = i, p = 0.5, N = 10)
}
for (i in 1:n) {
unif_draw <- runif(n = 1, min = min, max = max)
dist_to_0 = cdf_vals - unif_draw
draw <- which.min(abs(dist_to_0))
draw[i] <- draw
}
}
r_ztbinom_book(100, 10, 0.5)
r_ztbinom_book <- function(n, N, p) {
draws <- rep(NA, n)
upper = N*10
min = cdf_ztbinom_book(k = 1, p = p, N = N)
max = cdf_ztbinom_book(k = upper, p = p, N = N)
# cdf_vals <- cdf_ztbinom_book(seq(1, N*10, 1), p = p, N = N)
cdf_vals <- rep(0, upper)
for (i in 1:upper) {
cdf_vals[i] <- cdf_ztbinom_book(k = i, p = 0.5, N = 10)
}
for (i in 1:n) {
unif_draw <- runif(n = 1, min = min, max = max)
dist_to_0 = cdf_vals - unif_draw
draw <- which.min(abs(dist_to_0))
draws[i] <- draw
}
return()
}
r_ztbinom_book <- function(n, N, p) {
draws <- rep(NA, n)
upper = N*10
min = cdf_ztbinom_book(k = 1, p = p, N = N)
max = cdf_ztbinom_book(k = upper, p = p, N = N)
# cdf_vals <- cdf_ztbinom_book(seq(1, N*10, 1), p = p, N = N)
cdf_vals <- rep(0, upper)
for (i in 1:upper) {
cdf_vals[i] <- cdf_ztbinom_book(k = i, p = 0.5, N = 10)
}
for (i in 1:n) {
unif_draw <- runif(n = 1, min = min, max = max)
dist_to_0 = cdf_vals - unif_draw
draw <- which.min(abs(dist_to_0))
draws[i] <- draw
}
return(draws)
}
r_ztbinom_book(100, 10, 0.5)
hist(r_ztbinom_book(100, 10, 0.5))
hist(r_ztbinom_book(10000, 10, 0.5))
# pdf build
pdf <- d_ztbinom_book(k = seq(1, 1000, 1), p = 0.5, N = 10)
pdf_df <- as.data.frame(pdf)
pdf_df <- pdf_df |>
mutate(k = seq(1, 1000, 1)) |>
rename(prob = pdf)
pdf_df |>
ggplot(aes(x = k, y = prob)) +
geom_line() +
theme_bw()
sum(pdf)
# pdf build
pdf <- d_ztbinom_book(k = seq(1, 20, 1), p = 0.5, N = 10)
pdf_df <- as.data.frame(pdf)
pdf_df <- pdf_df |>
mutate(k = seq(1, 20, 1)) |>
rename(prob = pdf)
pdf_df |>
ggplot(aes(x = k, y = prob)) +
geom_line() +
theme_bw()
sum(pdf)
d <- r_ztbinom_book(100, 10, 0.5)
d <- as.data.frame(d)
View(d)
d <- r_ztbinom_book(100, 10, 0.5)
d <- as.data.frame(d) |>
mutate(draws = d)
d |>
ggplot(aes(x = ))
d |>
ggplot(aes(x = draws)) +
geom_histogram()
d <- r_ztbinom_book(100, 10, 0.5)
d <- as.data.frame(d) |>
mutate(draws = d)
d |>
ggplot(aes(x = draws)) +
geom_histogram(binwidth = 1)
View(d)
d <- r_ztbinom_book(100, 10, 0.5)
d <- as.data.frame(d) |>
rename(draws = d)
d |>
ggplot(aes(x = draws)) +
geom_histogram(binwidth = 1)
View(d)
set.seed(1)
d <- r_ztbinom_book(100, 10, 0.5)
d <- as.data.frame(d) |>
rename(draws = d)
d |>
ggplot(aes(x = draws)) +
geom_histogram(binwidth = 1)
set.seed(1)
d <- r_ztbinom_book(1000, 10, 0.5)
d <- as.data.frame(d) |>
rename(draws = d)
d |>
ggplot(aes(x = draws)) +
geom_histogram(binwidth = 1)
set.seed(1)
d <- r_ztbinom_book(100, 10, 0.5)
d <- as.data.frame(d) |>
rename(draws = d)
d |>
ggplot(aes(x = draws)) +
geom_histogram(binwidth = 1)
library(tidyverse)
d_ztbinom_book <- function(k, p, N) {
q = p + 1
prob = (1/(1-(q^-N))) * choose(n = N+k-1, k = N-1) * (p/q)^k * (1 - (p/q))^N
return(prob)
}
cdf_ztbinom_book <- function(k, p, N) {
q = p + 1
cumulative_prob <- 0
for (i in 1:k) {
cumulative_prob = cumulative_prob + d_ztbinom_book(i, p, N)
}
return(cumulative_prob)
}
mean_ztbinom_book <- function(p, N) {
q = p + 1
mean = N*p / (1-(q^-N))
return(mean)
}
var_ztbinom_book <- function(p, N) {
q = p + 1
var = ( (N*p*q) / (1-(q^-N)) ) * ( 1 - (N*p / q) * ( 1 / (1-(q^-N)) - 1)  )
return(var)
}
d_ztbinom_book(k = 3, p = 0.5, N = 10)
cdf_ztbinom_book(k = 25, p = 0.5, N = 10)
mean_ztbinom_book(p = 0.5, N = 10)
var_ztbinom_book(p = 0.5, N = 10)
# pdf build
pdf <- d_ztbinom_book(k = seq(1, 20, 1), p = 0.5, N = 10)
pdf_df <- as.data.frame(pdf)
pdf_df <- pdf_df |>
mutate(k = seq(1, 20, 1)) |>
rename(prob = pdf)
pdf_df |>
ggplot(aes(x = k, y = prob)) +
geom_line() +
theme_bw()
sum(pdf)
cdf <- rep(0, 20)
for (i in 1:20) {
cdf[i] <- cdf_ztbinom_book(k = i, p = 0.5, N = 10)
}
cdf_df <- as.data.frame(cdf)
cdf_df <- cdf_df |>
mutate(k = seq(1, 20, 1)) |>
rename(prob = cdf)
cdf_df |>
ggplot(aes(x = k, y = prob)) +
geom_line() +
theme_bw() +
scale_x_continuous(breaks = seq(0, 20, 1)) +
scale_y_continuous(breaks = seq(-0.1, 1, 0.1))
r_ztbinom_book <- function(n, p, N) {
draws <- rep(NA, n)
upper = N*10
min = cdf_ztbinom_book(k = 1, p = p, N = N)
max = cdf_ztbinom_book(k = upper, p = p, N = N)
# cdf_vals <- cdf_ztbinom_book(seq(1, N*10, 1), p = p, N = N)
cdf_vals <- rep(0, upper)
for (i in 1:upper) {
cdf_vals[i] <- cdf_ztbinom_book(k = i, p = 0.5, N = 10)
}
for (i in 1:n) {
unif_draw <- runif(n = 1, min = min, max = max)
dist_to_0 = cdf_vals - unif_draw
draw <- which.min(abs(dist_to_0))
draws[i] <- draw
}
return(draws)
}
set.seed(1)
n = 100
N = 10
p = 0.5
d <- r_ztbinom_book(n, p, N)
d <- as.data.frame(d) |>
rename(draws = d)
d |>
ggplot(aes(x = draws)) +
geom_histogram(binwidth = 1) +
theme_bw()
set.seed(1)
n = 100
N = 10
p = 0.5
d <- r_ztbinom_book(n, p, N) |>
as.data.frame(d) |>
rename(draws = d)
d <- r_ztbinom_book(n, p, N) |>
draws <- as.data.frame(d) |>
rename(draws = d) |>
mutate(pdf = pdf_df$prob)
set.seed(1)
n = 100
N = 10
p = 0.5
pdf <- d_ztbinom_book(k = seq(1, N*10, 1), p = p, N = N)
pdf_df <- as.data.frame(pdf)
pdf_df <- pdf_df |>
mutate(k = seq(1, N*10, 1)) |>
rename(prob = pdf)
d <- r_ztbinom_book(n, p, N) |>
draws <- as.data.frame(d) |>
rename(draws = d) |>
mutate(pdf = pdf_df$prob)
set.seed(1)
n = 100
N = 10
p = 0.5
pdf <- d_ztbinom_book(k = seq(1, N*10, 1), p = p, N = N)
pdf_df <- as.data.frame(pdf)
pdf_df <- pdf_df |>
mutate(k = seq(1, N*10, 1)) |>
rename(prob = pdf)
d <- r_ztbinom_book(n, p, N)
draws <- as.data.frame(d) |>
rename(draws = d) |>
mutate(pdf = pdf_df$prob)
draws |>
ggplot(aes(x = draws)) +
geom_histogram(binwidth = 1) +
theme_bw() +
geom_line()
set.seed(1)
n = 100
N = 10
p = 0.5
pdf <- d_ztbinom_book(k = seq(1, N*10, 1), p = p, N = N)
pdf_df <- as.data.frame(pdf)
pdf_df <- pdf_df |>
mutate(k = seq(1, N*10, 1)) |>
rename(prob = pdf)
d <- r_ztbinom_book(n, p, N)
draws <- as.data.frame(d) |>
rename(draws = d) |>
mutate(pdf = pdf_df$prob)
draws |>
ggplot(aes(x = draws)) +
geom_histogram(binwidth = 1) +
theme_bw() +
geom_line(aes(y = pdf))
set.seed(1)
n = 100
N = 10
p = 0.5
pdf <- d_ztbinom_book(k = seq(1, N*10, 1), p = p, N = N)
pdf_df <- as.data.frame(pdf)
pdf_df <- pdf_df |>
mutate(k = seq(1, N*10, 1)) |>
rename(prob = pdf)
d <- r_ztbinom_book(n, p, N)
draws <- as.data.frame(d) |>
rename(draws = d) |>
mutate(pdf = pdf_df$prob,
norm_draws = 1/draws)
draws |>
ggplot(aes(x = norm_draws)) +
geom_histogram(binwidth = 1) +
theme_bw() +
geom_line(aes(y = pdf))
set.seed(1)
n = 100
N = 10
p = 0.5
pdf <- d_ztbinom_book(k = seq(1, N*10, 1), p = p, N = N)
pdf_df <- as.data.frame(pdf)
pdf_df <- pdf_df |>
mutate(k = seq(1, N*10, 1)) |>
rename(prob = pdf)
d <- r_ztbinom_book(n, p, N)
draws <- as.data.frame(d) |>
rename(draws = d) |>
mutate(pdf = pdf_df$prob,
norm_draws = 1/draws)
draws |>
ggplot(aes(x = norm_draws)) +
geom_histogram(binwidth = 0.1) +
theme_bw() +
geom_line(aes(y = pdf))
set.seed(1)
n = 100
N = 10
p = 0.5
pdf <- d_ztbinom_book(k = seq(1, N*10, 1), p = p, N = N)
pdf_df <- as.data.frame(pdf)
pdf_df <- pdf_df |>
mutate(k = seq(1, N*10, 1)) |>
rename(prob = pdf)
d <- r_ztbinom_book(n, p, N)
draws <- as.data.frame(d) |>
rename(draws = d) |>
mutate(pdf = pdf_df$prob)
draws |>
ggplot(aes(x = draws)) +
geom_histogram(binwidth = 1) +
theme_bw() +
geom_line(aes(y = pdf))
set.seed(1)
n = 100
N = 10
p = 0.5
pdf <- d_ztbinom_book(k = seq(1, N*10, 1), p = p, N = N)
pdf_df <- as.data.frame(pdf)
pdf_df <- pdf_df |>
mutate(k = seq(1, N*10, 1)) |>
rename(prob = pdf)
d <- r_ztbinom_book(n, p, N)
draws <- as.data.frame(d) |>
rename(draws = d) |>
mutate(pdf = pdf_df$prob)
draws |>
ggplot(aes(x = draws)) +
geom_histogram(binwidth = 1) +
theme_bw() +
geom_line(aes(y = pdf*20))
View(draws)
set.seed(1)
n = 100
N = 10
p = 0.5
pdf <- d_ztbinom_book(k = seq(1, N*10, 1), p = p, N = N)
pdf_df <- as.data.frame(pdf)
pdf_df <- pdf_df |>
mutate(k = seq(1, N*10, 1)) |>
rename(prob = pdf)
pdf_df |>
ggplot(aes(x = k, y = prob)) +
geom_line() +
theme_bw()
d <- r_ztbinom_book(n, p, N)
draws <- as.data.frame(d) |>
rename(draws = d)
draws |>
ggplot(aes(x = draws)) +
geom_histogram(binwidth = 1) +
theme_bw() +
geom_line(aes(y = pdf))
set.seed(1)
n = 10000
N = 10
p = 0.5
# pdf <- d_ztbinom_book(k = seq(1, N*10, 1), p = p, N = N)
#
# pdf_df <- as.data.frame(pdf)
#
# pdf_df <- pdf_df |>
#   mutate(k = seq(1, N*10, 1)) |>
#   rename(prob = pdf)
#
# pdf_df |>
#   ggplot(aes(x = k, y = prob)) +
#   geom_line() +
#   theme_bw()
d <- r_ztbinom_book(n, p, N)
draws <- as.data.frame(d) |>
rename(draws = d)
draws |>
ggplot(aes(x = draws)) +
geom_histogram(binwidth = 1) +
theme_bw() +
geom_line(aes(y = pdf))
set.seed(1)
n = 10000
N = 10
p = 0.5
# pdf <- d_ztbinom_book(k = seq(1, N*10, 1), p = p, N = N)
#
# pdf_df <- as.data.frame(pdf)
#
# pdf_df <- pdf_df |>
#   mutate(k = seq(1, N*10, 1)) |>
#   rename(prob = pdf)
#
# pdf_df |>
#   ggplot(aes(x = k, y = prob)) +
#   geom_line() +
#   theme_bw()
d <- r_ztbinom_book(n, p, N)
draws <- as.data.frame(d) |>
rename(draws = d)
draws |>
ggplot(aes(x = draws)) +
geom_histogram(binwidth = 1) +
theme_bw()
mean(draws$draws)
var(draws$draws)
set.seed(1)
n = 100000
N = 10
p = 0.5
# pdf <- d_ztbinom_book(k = seq(1, N*10, 1), p = p, N = N)
#
# pdf_df <- as.data.frame(pdf)
#
# pdf_df <- pdf_df |>
#   mutate(k = seq(1, N*10, 1)) |>
#   rename(prob = pdf)
#
# pdf_df |>
#   ggplot(aes(x = k, y = prob)) +
#   geom_line() +
#   theme_bw()
d <- r_ztbinom_book(n, p, N)
draws <- as.data.frame(d) |>
rename(draws = d)
draws |>
ggplot(aes(x = draws)) +
geom_histogram(binwidth = 1) +
theme_bw()
mean(draws$draws)
var(draws$draws)
pdf <- d_ztbinom_book(k = seq(1, 20, 1), p = 0.5, N = 10)
pdf_df <- as.data.frame(pdf)
pdf_df <- pdf_df |>
mutate(k = seq(1, 20, 1)) |>
rename(prob = pdf)
pdf_df |>
ggplot(aes(x = k, y = prob)) +
geom_line() +
theme_bw()
sum(pdf)
pdf <- d_ztbinom_book(k = seq(1, 20, 1), p = 0.5, N = 10)
pdf_df <- as.data.frame(pdf)
pdf_df <- pdf_df |>
mutate(k = seq(1, 20, 1)) |>
rename(prob = pdf)
pdf_df |>
ggplot(aes(x = k, y = prob)) +
geom_line() +
theme_bw()
# sum(pdf)
