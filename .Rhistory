# Calculate the mean and variance of the negative binomial distribution
mean_var <- neg_binom_mean_var(p, r)
if(debug) cat(p, r, mean_var[1], mean_var[2], "\n")
# Calculate squared differences between desired and calculated mean and variance
diff_mean <- mean_var[1] - desired_mean
diff_var <- mean_var[2] - desired_var
# Return the sum of squared differences
return(diff_mean^2 + diff_var^2)
}
# Desired mean and variance of the negative binomial distribution
desired_mean <- calculated_mean
desired_var <- calculated_var
# Initial values for p and r
initial_values <- c(p = 0.5, r = 5)
# Use optim() to find values of p and r that minimize the objective function
result <- optim(par = initial_values, fn = objective_function, desired_mean = desired_mean, desired_var = desired_var, method = "L-BFGS-B", lower = c(0, 0), upper = c(1, Inf))
# Extract the optimized values of p and r from the result
opt_p <- result$par[1]
opt_r <- result$par[2]
# Calculate the optimized mean and variance of the negative binomial distribution
opt_mean_var <- neg_binom_mean_var(opt_p, opt_r)
opt_mean <- opt_mean_var[1]
opt_var <- opt_mean_var[2]
# Print the optimized values
print(paste("Optimized p:", opt_p))
print(paste("Optimized r:", opt_r))
print(paste("Optimized mean:", opt_mean))
print(paste("Optimized variance:", opt_var))
dnbinom(0, p, r)
dnbinom(0, prob = p, size = r)
dnbinom(0, prob = p, size = r)
values <- c(1:100000)
Eof_x_sqrd <- values^2 * (dnbinom(values, prob = p, size = r))
hist(Eof_x_sqrd)
Eof_x_sqrd <- Eof_x_sqrd / (1 - dnbinom(0, prob = p, size = r))
hist(Eof_x_sqrd)
Eof_x <- values * (dnbinom(values, prob = p, size = r))
Eof_x <- Eof_x / (1 - dnbinom(0, prob = p, size = r))
Eof_x
Eof_x <- sum(Eof_x)^2
Eof_x_sqrd <- sum(Eof_x_sqrd)
hist(Eof_x_sqrd)
rnbinom(1000, 2, 3)
rnbinom(1000, 2, 3, 2)
rnbinom(1000, prob = 0.5, size = 3)
hist(rnbinom(1000, prob = 0.5, size = 3))
# Function to calculate the mean and variance of the negative binomial distribution
neg_binom_mean_var <- function(p, r) {
mu <- r* (1 - p) / p
mean_val <- mu / (1 - dnbinom(0, prob = p, size = r))
muvalues <- c(1:100000)
Eof_x_sqrd <- values^2 * (dnbinom(values, prob = p, size = r))
Eof_x_sqrd <- Eof_x_sqrd / (1 - dnbinom(0, prob = p, size = r))
Eof_x <- values * (dnbinom(values, prob = p, size = r))
Eof_x <- Eof_x / (1 - dnbinom(0, prob = p, size = r))
Eof_x <- sum(Eof_x)^2
Eof_x_sqrd <- sum(Eof_x_sqrd)
var_val <- (Eof_x_sqrd - Eof_x)
return(c(mean_val, var_val))
}
neg_binom_mean_var(0.5, 3)
# Function to calculate the mean and variance of the negative binomial distribution
neg_binom_mean_var <- function(p, r) {
mu <- r* (1 - p) / p
mean_val <- mu / (1 - dnbinom(0, prob = p, size = r))
values <- c(1:100000)
Eof_x_sqrd <- values^2 * (dnbinom(values, prob = p, size = r))
Eof_x_sqrd <- Eof_x_sqrd / (1 - dnbinom(0, prob = p, size = r))
Eof_x <- values * (dnbinom(values, prob = p, size = r))
Eof_x <- Eof_x / (1 - dnbinom(0, prob = p, size = r))
Eof_x <- sum(Eof_x)^2
Eof_x_sqrd <- sum(Eof_x_sqrd)
var_val <- (Eof_x_sqrd - Eof_x)
return(c(mean_val, var_val))
}
neg_binom_mean_var(0.5, 3)
3.428/5.387
3.42^2
11.6964/5.3-3.4
11.6964/(5.3-3.4)
mu <- r* (1 - p) / p
mu <- r* (1 - p) / p
p = 0.5
r = 3
mu <- r* (1 - p) / p
mean_val <- mu / (1 - dnbinom(0, prob = p, size = r))
values <- c(1:100000)
# Function to calculate the mean and variance of the negative binomial distribution
neg_binom_mean_var <- function(p, r) {
mu <- r* (1 - p) / p
mean_val <- mu / (1 - dnbinom(0, prob = p, size = r))
values <- c(1:100000)
Eof_x_sqrd <- values^2 * (dnbinom(values, prob = p, size = r))
Eof_x_sqrd <- Eof_x_sqrd / (1 - dnbinom(0, prob = p, size = r))
Eof_x <- values * (dnbinom(values, prob = p, size = r))
Eof_x <- Eof_x / (1 - dnbinom(0, prob = p, size = r))
Eof_x <- sum(Eof_x)^2
Eof_x_sqrd <- sum(Eof_x_sqrd)
var_val <- (Eof_x_sqrd - Eof_x)
return(c(mean_val, var_val))
}
neg_binom_mean_var(0.5, 3)
neg_binom_mean_var(0.5, 3)
x <- rnbinom(0.5, 3)
x <- rnbinom(prob = 0.5, size = 3)
x <- rnbinom(10000, prob = 0.5, size = 3)
as.data.frame(x)
?nztpois()
?rnorm
view(rnorm)
library(tidyverse)
view(rnorm)
ztbinom_book <- function(n, k, p, N) {
q = p + 1
prob = (1/(1-(q^-N))) * choose(n = N+k-1, k = N-1) * (p/q)^k * (1 - (p/q))^N
return(prob)
}
ztbinom_book <- function(k, p, N) {
q = p + 1
prob = (1/(1-(q^-N))) * choose(n = N+k-1, k = N-1) * (p/q)^k * (1 - (p/q))^N
return(prob)
}
ztbinom_book(k = 3, p = 0.5, N = 10)
1.5^-10
1-0.01734153
1/0.9826585
choose(12, 9)
(1/3)^3
(2/3)^10
1.017648 * 220 * 0.03703704 * 0.01734153
?pnorm()
dnorm(0, 2, 3)
dnorm(2, 2, 3)
d_ztbinom_book <- function(k, p, N) {
q = p + 1
prob = (1/(1-(q^-N))) * choose(n = N+k-1, k = N-1) * (p/q)^k * (1 - (p/q))^N
return(prob)
}
d_ztbinom_book(k = 3, p = 0.5, N = 10)
d_ztbinom_book <- function(k, p, N) {
q = p + 1
prob = (1/(1-(q^-N))) * choose(n = N+k-1, k = N-1) * (p/q)^k * (1 - (p/q))^N
return(prob)
}
d_ztbinom_book(k = 3, p = 0.5, N = 10)
dnbinom(3, 10, 0.5)
pdf <- d_ztbinom_book(k = seq(0, 100, 1), p = 0.5, N = 10)
plot(seq(0, 100, 1), pdf)
# pdf build
pdf <- d_ztbinom_book(k = seq(1, 20, 1), p = 0.5, N = 10)
plot(seq(1, 20, 1), pdf)
# pdf build
pdf <- d_ztbinom_book(k = seq(1, 20, 1), p = 0.5, N = 10)
plot(seq(1, 20, 1), pdf, type = "l")
sum(pdf)
mean_ztbinom <- function(k, p, N) {
q = p + 1
mean = N*p / (1-(q^-N))
return(mean)
}
mean_ztbinom_book <- function(p, N) {
q = p + 1
mean = N*p / (1-(q^-N))
return(mean)
}
d_ztbinom_book(k = 3, p = 0.5, N = 10)
mean_ztbinom_book(p = 0.5, N = 10)
var_ztbinom_book <- function(p, N) {
q = p + 1
var = ((N*p*q) / (1-(q^-N))) * (1 - (1/N*p*q)) * (1 / (1-(q^-N)) - 1)
return(var)
}
d_ztbinom_book(k = 3, p = 0.5, N = 10)
mean_ztbinom_book(p = 0.5, N = 10)
var_ztbinom_book(p = 0.5, N = 10)
d_ztbinom_book(k = 3, p = 0.5, N = 10)
mean_ztbinom_book(p = 0.5, N = 50)
var_ztbinom_book(p = 0.5, N = 50)
d_ztbinom_book(k = 5, p = 0.5, N = 10)
mean_ztbinom_book(p = 0.5, N = 10)
var_ztbinom_book(p = 0.5, N = 10)
var_ztbinom_book <- function(p, N) {
q = p + 1
var = ((N*p*q) / (1-(q^-N))) * (1 - (N*p / q)) * (1 / (1-(q^-N)) - 1)
return(var)
}
d_ztbinom_book(k = 5, p = 0.5, N = 10)
mean_ztbinom_book(p = 0.5, N = 10)
var_ztbinom_book(p = 0.5, N = 10)
var_ztbinom_book <- function(p, N) {
q = p + 1
var = ((N*p*q) / (1-(q^-N))) * ( 1 - (N*p / q * ( 1 / (1-(q^-N)) ) - 1) )
return(var)
}
d_ztbinom_book(k = 5, p = 0.5, N = 10)
mean_ztbinom_book(p = 0.5, N = 10)
var_ztbinom_book(p = 0.5, N = 10)
q = 1.5
N = 10
(1-(q^-N))
p =0.5
( (N*p*q) / (1-(q^-N)) ) * ( 1 - (N*p / q * ( 1 / (1-(q^-N)) ) - 1) )
(N*p / q * ( 1 / (1-(q^-N)) ) - 1)
( (N*p*q) / (1-(q^-N)) )
1 - (N*p / q * ( 1 / (1-(q^-N)) ) - 1)
1 - (N*p / q * ( 1 / (1-(q^-N)) ) - 1)
var_ztbinom_book <- function(p, N) {
q = p + 1
var = ( (N*p*q) / (1-(q^-N)) ) * ( 1 - (N*p / q) * ( 1 / (1-(q^-N))   - 1)  )
return(var)
}
d_ztbinom_book(k = 5, p = 0.5, N = 10)
mean_ztbinom_book(p = 0.5, N = 10)
var_ztbinom_book(p = 0.5, N = 10)
var_ztbinom_book <- function(p, N) {
q = p + 1
var = ((N*p*q) / (1-(q^-N))) * (1 - (1/N*p*q)) * (1 / (1-(q^-N)) - 1)
return(var)
}
var_ztbinom_book <- function(p, N) {
q = p + 1
var = ( (N*p*q) / (1-(q^-N)) ) * ( 1 - (N*p / q) * ( 1 / (1-(q^-N))   - 1)  )
return(var)
}
var_ztbinom_book <- function(p, N) {
q = p + 1
var = ((N*p*q) / (1-(q^-N))) * (1 - (1/N*p*q)) * (1 / (1-(q^-N)) - 1)
return(var)
}
var_ztbinom_book <- function(p, N) {
q = p + 1
var = ( (N*p*q) / (1-(q^-N)) ) * ( 1 - (N*p / q) * ( 1 / (1-(q^-N))   - 1)  )
return(var)
}
var_ztbinom_book <- function(p, N) {
q = p + 1
var = ( (N*p*q) / (1-(q^-N)) ) * ( 1 - (1 / N*p*q) * ( 1 / (1-(q^-N))   - 1)  )
return(var)
}
d_ztbinom_book(k = 5, p = 0.5, N = 10)
mean_ztbinom_book(p = 0.5, N = 10)
var_ztbinom_book(p = 0.5, N = 10)
var_ztbinom_book <- function(p, N) {
q = p + 1
var = ( (N*p*q) / (1-(q^-N)) ) * ( 1 - (N*p / q) * ( 1 / (1-(q^-N))   - 1)  )
return(var)
}
d_ztbinom_book(k = 5, p = 0.5, N = 10)
mean_ztbinom_book(p = 0.5, N = 10)
var_ztbinom_book(p = 0.5, N = 10)
var_ztbinom_book <- function(p, N) {
q = p + 1
var = ((N*p*q) / (1-(q^-N))) * (1 - (1/N*p*q)) * (1 / (1-(q^-N)) - 1)
return(var)
}
d_ztbinom_book(k = 5, p = 0.5, N = 10)
mean_ztbinom_book(p = 0.5, N = 10)
var_ztbinom_book(p = 0.5, N = 10)
# var_ztbinom_book <- function(p, N) {
#   q = p + 1
#
#   var = ((N*p*q) / (1-(q^-N))) * (1 - (1/N*p*q)) * (1 / (1-(q^-N)) - 1)
#
#   return(var)
# }
var_ztbinom_book <- function(p, N) {
q = p + 1
var = ( (N*p*q) / (1-(q^-N)) ) * ( 1 - (N*p / q) * ( 1 / (1-(q^-N))   - 1)  )
return(var)
}
d_ztbinom_book(k = 5, p = 0.5, N = 10)
mean_ztbinom_book(p = 0.5, N = 10)
var_ztbinom_book(p = 0.5, N = 10)
library(tidyverse)
d_ztbinom_book <- function(k, p, N) {
q = p + 1
prob = (1/(1-(q^-N))) * choose(n = N+k-1, k = N-1) * (p/q)^k * (1 - (p/q))^N
return(prob)
}
mean_ztbinom_book <- function(p, N) {
q = p + 1
mean = N*p / (1-(q^-N))
return(mean)
}
# var_ztbinom_book <- function(p, N) {
#   q = p + 1
#
#   var = ((N*p*q) / (1-(q^-N))) * (1 - (1/N*p*q)) * (1 / (1-(q^-N)) - 1)
#
#   return(var)
# }
var_ztbinom_book <- function(p, N) {
q = p + 1
var = ( (N*p*q) / (1-(q^-N)) ) * ( 1 - (N*p / q) * ( 1 / (1-(q^-N))   - 1)  )
return(var)
}
d_ztbinom_book(k = 5, p = 0.5, N = 10)
mean_ztbinom_book(p = 0.5, N = 10)
var_ztbinom_book(p = 0.5, N = 10)
# pdf build
pdf <- d_ztbinom_book(k = seq(1, 20, 1), p = 0.5, N = 10)
plot(seq(1, 20, 1), pdf, type = "l")
sum(pdf)
pdf_df <- as.data.frame(pdf)
View(pdf_df)
# pdf build
pdf <- d_ztbinom_book(k = seq(1, 20, 1), p = 0.5, N = 10)
pdf_df <- as.data.frame(pdf)
pdf_df <- pdf_df |>
mutate(k = seq(1, 20, 1)) |>
rename(prob = pdf)
pdf_df |>
ggplot(aes(x = k), y = prob)
sum(pdf)
# pdf build
pdf <- d_ztbinom_book(k = seq(1, 20, 1), p = 0.5, N = 10)
pdf_df <- as.data.frame(pdf)
pdf_df <- pdf_df |>
mutate(k = seq(1, 20, 1)) |>
rename(prob = pdf)
pdf_df |>
ggplot(aes(x = k, y = prob)) +
geom_density()
# pdf build
pdf <- d_ztbinom_book(k = seq(1, 20, 1), p = 0.5, N = 10)
pdf_df <- as.data.frame(pdf)
pdf_df <- pdf_df |>
mutate(k = seq(1, 20, 1)) |>
rename(prob = pdf)
pdf_df |>
ggplot(aes(x = k, y = prob)) +
geom_density(y = prob)
# pdf build
pdf <- d_ztbinom_book(k = seq(1, 20, 1), p = 0.5, N = 10)
pdf_df <- as.data.frame(pdf)
pdf_df <- pdf_df |>
mutate(k = seq(1, 20, 1)) |>
rename(prob = pdf)
pdf_df |>
ggplot(aes(x = k, y = prob)) +
geom_point()
sum(pdf)
# pdf build
pdf <- d_ztbinom_book(k = seq(1, 20, 1), p = 0.5, N = 10)
pdf_df <- as.data.frame(pdf)
pdf_df <- pdf_df |>
mutate(k = seq(1, 20, 1)) |>
rename(prob = pdf)
pdf_df |>
ggplot(aes(x = k, y = prob)) +
geom_line()
sum(pdf)
# pdf build
pdf <- d_ztbinom_book(k = seq(1, 20, 1), p = 0.5, N = 10)
pdf_df <- as.data.frame(pdf)
pdf_df <- pdf_df |>
mutate(k = seq(1, 20, 1)) |>
rename(prob = pdf)
pdf_df |>
ggplot(aes(x = k, y = prob)) +
geom_line() +
theme_bw()
sum(pdf)
# pdf build
pdf <- d_ztbinom_book(k = seq(1, 20, 1), p = 0.5, N = 10)
pdf_df <- as.data.frame(pdf)
pdf_df <- pdf_df |>
mutate(k = seq(1, 20, 1)) |>
rename(prob = pdf)
pdf_df |>
ggplot(aes(x = k, y = prob)) +
geom_line() +
theme_bw() +
scale_x_continuous(breaks = seq(0, 20, 1))
sum(pdf)
library(tidyverse)
d_ztbinom_book <- function(k, p, N) {
q = p + 1
prob = (1/(1-(q^-N))) * choose(n = N+k-1, k = N-1) * (p/q)^k * (1 - (p/q))^N
return(prob)
}
mean_ztbinom_book <- function(p, N) {
q = p + 1
mean = N*p / (1-(q^-N))
return(mean)
}
# var_ztbinom_book <- function(p, N) {
#   q = p + 1
#
#   var = ((N*p*q) / (1-(q^-N))) * (1 - (1/N*p*q)) * (1 / (1-(q^-N)) - 1)
#
#   return(var)
# }
var_ztbinom_book <- function(p, N) {
q = p + 1
var = ( (N*p*q) / (1-(q^-N)) ) * ( 1 - (N*p / q) * ( 1 / (1-(q^-N))   - 1)  )
return(var)
}
d_ztbinom_book(k = 5, p = 0.5, N = 10)
mean_ztbinom_book(p = 0.5, N = 10)
var_ztbinom_book(p = 0.5, N = 10)
# pdf build
pdf <- d_ztbinom_book(k = seq(1, 20, 1), p = 0.5, N = 10)
pdf_df <- as.data.frame(pdf)
pdf_df <- pdf_df |>
mutate(k = seq(1, 20, 1)) |>
rename(prob = pdf)
pdf_df |>
ggplot(aes(x = k, y = prob)) +
geom_line() +
theme_bw() +
scale_x_continuous(breaks = seq(0, 20, 1))
sum(pdf)
d_ztbinom_book <- function(k, p, N) {
q = p + 1
prob = (1/(1-(q^-N))) * choose(n = N+k-1, k = N-1) * (p/q)^k * (1 - (p/q))^N
return(prob)
}
library(tidyverse)
d_ztbinom_book <- function(k, p, N) {
q = p + 1
prob = (1/(1-(q^-N))) * choose(n = N+k-1, k = N-1) * (p/q)^k * (1 - (p/q))^N
return(prob)
}
mean_ztbinom_book <- function(p, N) {
q = p + 1
mean = N*p / (1-(q^-N))
return(mean)
}
# var_ztbinom_book <- function(p, N) {
#   q = p + 1
#
#   var = ((N*p*q) / (1-(q^-N))) * (1 - (1/N*p*q)) * (1 / (1-(q^-N)) - 1)
#
#   return(var)
# }
var_ztbinom_book <- function(p, N) {
q = p + 1
var = ( (N*p*q) / (1-(q^-N)) ) * ( 1 - (N*p / q) * ( 1 / (1-(q^-N))   - 1)  )
return(var)
}
d_ztbinom_book(k = 5, p = 0.5, N = 10)
mean_ztbinom_book(p = 0.5, N = 10)
var_ztbinom_book(p = 0.5, N = 10)
# pdf build
pdf <- d_ztbinom_book(k = seq(1, 20, 1), p = 0.5, N = 10)
pdf_df <- as.data.frame(pdf)
pdf_df <- pdf_df |>
mutate(k = seq(1, 20, 1)) |>
rename(prob = pdf)
pdf_df |>
ggplot(aes(x = k, y = prob)) +
geom_line() +
theme_bw() +
scale_x_continuous(breaks = seq(0, 20, 1))
sum(pdf)
# pdf build
pdf <- d_ztbinom_book(k = seq(0, 20, 1), p = 0.5, N = 10)
pdf_df <- as.data.frame(pdf)
pdf_df <- pdf_df |>
mutate(k = seq(1, 20, 1)) |>
rename(prob = pdf)
# pdf build
pdf <- d_ztbinom_book(k = seq(0, 20, 1), p = 0.5, N = 10)
pdf_df <- as.data.frame(pdf)
pdf_df <- pdf_df |>
mutate(k = seq(0, 20, 1)) |>
rename(prob = pdf)
pdf_df |>
ggplot(aes(x = k, y = prob)) +
geom_line() +
theme_bw() +
scale_x_continuous(breaks = seq(0, 20, 1))
sum(pdf)
library(tidyverse)
d_ztbinom_book <- function(k, p, N) {
q = p + 1
prob = (1/(1-(q^-N))) * choose(n = N+k-1, k = N-1) * (p/q)^k * (1 - (p/q))^N
return(prob)
}
mean_ztbinom_book <- function(p, N) {
q = p + 1
mean = N*p / (1-(q^-N))
return(mean)
}
# var_ztbinom_book <- function(p, N) {
#   q = p + 1
#
#   var = ((N*p*q) / (1-(q^-N))) * (1 - (1/N*p*q)) * (1 / (1-(q^-N)) - 1)
#
#   return(var)
# }
var_ztbinom_book <- function(p, N) {
q = p + 1
var = ( (N*p*q) / (1-(q^-N)) ) * ( 1 - (N*p / q) * ( 1 / (1-(q^-N))   - 1)  )
return(var)
}
d_ztbinom_book(k = 5, p = 0.5, N = 10)
mean_ztbinom_book(p = 0.5, N = 10)
var_ztbinom_book(p = 0.5, N = 10)
# pdf build
pdf <- d_ztbinom_book(k = seq(1, 20, 1), p = 0.5, N = 10)
pdf_df <- as.data.frame(pdf)
pdf_df <- pdf_df |>
mutate(k = seq(1, 20, 1)) |>
rename(prob = pdf)
pdf_df |>
ggplot(aes(x = k, y = prob)) +
geom_line() +
theme_bw() +
scale_x_continuous(breaks = seq(0, 20, 1))
sum(pdf)
